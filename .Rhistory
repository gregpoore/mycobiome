findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 12/12 | TCGA: 12/62 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Glioblastoma", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 33/33 | TCGA: 33/62 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Lung Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: weizmann: 20/31 | TCGA: 20/35 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Melanoma", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 22/25 | TCGA: 22/52 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Bone Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="bone")
#---------------------------RNA comparisons---------------------------#
# Note that bone cancer / sarcoma is only available via WGS
# breast: weizmann: 25/44 | TCGA: 25/33 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Breast Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  8/10 | TCGA: 8/32 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 12/12 | TCGA: 12/62 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Glioblastoma", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 32/33 | TCGA: 32/58 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Lung Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: weizmann: 14/31 | TCGA: 8/12 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Melanoma", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 25/25 | TCGA: 25/62 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
# pancreas: weizmann: 8/14 | TCGA: 8/26 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Pancreatic Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="pancreas")
#---------------------------WGS+RNA comparisons---------------------------#
# bone: weizmann: 13/16 | TCGA: 13/43 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Bone Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="bone")
# breast: weizmann: 43/44 | TCGA: 43/59 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Breast Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  10/10 | TCGA: 10/60 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 12/12 | TCGA: 12/62 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Glioblastoma", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 33/33 | TCGA: 33/62 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Lung Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: weizmann: 23/31 | TCGA: 23/41 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Melanoma", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 25/25 | TCGA: 25/62 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
# pancreas: weizmann: 8/14 | TCGA: 8/26 (genus)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Pancreatic Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="pancreas")
#---------------------------WGS comparisons at genus level---------------------------#
# bone: 11/14 (Weizmann) | 11/37 (TCGA)
source("00-Functions.R")
# bone: 11/14 (Weizmann) | 11/37 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Bone Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="bone")
# breast: weizmann: 37/38 (Weizmann) | 37/51 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Breast Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  10/10 (Weizmann) | 10/52 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 10/10 (Weizmann) | 10/54 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Glioblastoma", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 28/28 (Weizmann) | 28/54 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Lung Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: 10/15 (Weizmann) | 10/29 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Melanoma", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 21/24 (Weizmann) | 21/44 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
#---------------------------RNA comparisons at genus level---------------------------#
# Note that bone cancer / sarcoma is only available via WGS
# breast: weizmann: 24/38 (Weizmann) | 24/30 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Breast Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  8/10 (Weizmann) | 8/26 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 10/10 (Weizmann) | 10/54 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Glioblastoma", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 27/28 (Weizmann) | 27/50 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Lung Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: weizmann: 9/15 (Weizmann) | 9/19 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Melanoma", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 24/24 (Weizmann) | 24/54 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
# pancreas: weizmann: 8/13 (Weizmann) | 8/22 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Pancreatic Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="pancreas")
#---------------------------WGS+RNA comparisons at genus level---------------------------#
# bone: weizmann: 11/14 (Weizmann) | 11/37 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Bone Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="bone")
# breast: weizmann: 37/38 (Weizmann) | 37/51 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Breast Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  10/10 (Weizmann) | 10/52 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 10/10 (Weizmann) | 10/54 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Glioblastoma", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 28/28 (Weizmann) | 28/54 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Lung Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: weizmann: 13/15 (Weizmann) | 13/34 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Melanoma", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 24/24 (Weizmann) | 24/54 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
# pancreas: weizmann: 8/13 (Weizmann) | 8/22 (TCGA)
findPrevGenus(countData=rep200FungiGenusShared_8cancer, cancerType = "Pancreatic Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="pancreas")
source("00-Functions.R") # for the following functions:
#---------------------------WGS comparisons at species level---------------------------#
# bone: 11/14 (Weizmann) | 11/37 (TCGA)
source("00-Functions.R")
# bone: 11/14 (Weizmann) | 11/37 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Bone Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="bone")
# breast: weizmann: 37/38 (Weizmann) | 37/51 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Breast Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  10/10 (Weizmann) | 10/52 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# colon: weizmann:  7/8 (Weizmann) | 7/30 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 10/10 (Weizmann) | 10/54 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Glioblastoma", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 28/28 (Weizmann) | 28/54 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Lung Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: 10/15 (Weizmann) | 10/29 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Melanoma", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# melanoma: 6/11 (Weizmann) | 6/15 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Melanoma", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 21/24 (Weizmann) | 21/44 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = FALSE,
seqCenter = seqCentersWGS, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
#---------------------------RNA comparisons at species level---------------------------#
# Note that bone cancer / sarcoma is only available via WGS
# breast: weizmann: 24/38 (Weizmann) | 24/30 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Breast Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  8/10 (Weizmann) | 8/26 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 10/10 (Weizmann) | 10/54 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Glioblastoma", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 27/28 (Weizmann) | 27/50 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Lung Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: weizmann: 9/15 (Weizmann) | 9/19 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Melanoma", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 24/24 (Weizmann) | 24/54 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
# pancreas: weizmann: 8/13 (Weizmann) | 8/22 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Pancreatic Cancer", taxaFlag = TRUE,
seqCenter = seqCentersRNA, weizmannIntersectFlag=TRUE, weizmannTissue="pancreas")
#---------------------------WGS+RNA comparisons at species level---------------------------#
# bone: weizmann: 11/14 (Weizmann) | 11/37 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Bone Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="bone")
# breast: weizmann: 37/38 (Weizmann) | 37/51 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Breast Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="breast")
# colon: weizmann:  10/10 (Weizmann) | 10/52 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Colorectal Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="colon")
# gbm: weizmann: 10/10 (Weizmann) | 10/54 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Glioblastoma", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="gbm")
# lung: weizmann: 28/28 (Weizmann) | 28/54 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Lung Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="lung")
# melanoma: weizmann: 13/15 (Weizmann) | 13/34 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Melanoma", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="melanoma")
# ovary: weizmann: 24/24 (Weizmann) | 24/54 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Ovarian Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="ovary")
# pancreas: weizmann: 8/13 (Weizmann) | 8/22 (TCGA)
findPrevSpecies(countData=rep200FungiSpeciesShared_8cancer, cancerType = "Pancreatic Cancer", taxaFlag = TRUE,
seqCenter = seqCentersAll, weizmannIntersectFlag=TRUE, weizmannTissue="pancreas")
ggbarplot(wgsOverlapGenus, "cancer_type", "genus",
fill = "dataset", color = "dataset", palette = "Paired", ylim=c(0,50),
xlab = "Cancer/tissue type (tumor and NAT combined when available)", ylab = "Genus count",
title = "Overlapping fungal genera between TCGA WGS and Weizmann datasets\n(note: intersection among features found in rep200 database)",
label = TRUE, lab.col = "black", lab.pos = "out") +
theme(plot.title = element_text(hjust = 0.5), legend.title=element_blank()) +
ggsave(file = "Figures/Supplementary_Figures/wgs_overlap_rep200_reduced_feature_space_genus.png",
dpi = "retina", width = 9, height = 4, units = "in")
#---------------------------Plot comparisons using genus---------------------------#
# Create data frame with data
wgsOverlapGenus <- data.frame(dataset=rep(c("Weizmann only", "Found in Weizmann and TCGA"), 7),
cancer_type=rep(c("Bone", "Breast", "Colorectal", "Glioblastoma","Lung","Melanoma","Ovarian"),each=2),
genus = c(3, 11, 1, 37, 0, 10, 0, 10, 0, 28, 5, 10, 3, 21))
ggbarplot(wgsOverlapGenus, "cancer_type", "genus",
fill = "dataset", color = "dataset", palette = "Paired", ylim=c(0,50),
xlab = "Cancer/tissue type (tumor and NAT combined when available)", ylab = "Genus count",
title = "Overlapping fungal genera between TCGA WGS and Weizmann datasets\n(note: intersection among features found in rep200 database)",
label = TRUE, lab.col = "black", lab.pos = "out") +
theme(plot.title = element_text(hjust = 0.5), legend.title=element_blank()) +
ggsave(file = "Figures/Supplementary_Figures/wgs_overlap_rep200_reduced_feature_space_genus.png",
dpi = "retina", width = 9, height = 4, units = "in")
ggbarplot(rnaOverlapGenus, "cancer_type", "genus",
fill = "dataset", color = "dataset", palette = "Paired", ylim=c(0,50),
xlab = "Cancer/tissue type (tumor and NAT combined when available)", ylab = "Genus count",
title = "Overlapping fungal genera between TCGA RNA-Seq and Weizmann datasets\n(note: intersection among features found in rep200 database)",
label = TRUE, lab.col = "black", lab.pos = "out") +
theme(plot.title = element_text(hjust = 0.5), legend.title=element_blank()) +
ggsave(file = "Figures/Supplementary_Figures/rnaseq_overlap_rep200_reduced_feature_space_genus.png",
dpi = "retina", width = 9, height = 4, units = "in")
rnaOverlapGenus <- data.frame(dataset=rep(c("Weizmann only", "Found in Weizmann and TCGA"), 7),
cancer_type=rep(c("Breast", "Colorectal", "Glioblastoma","Lung","Melanoma","Ovarian","Pancreatic"),each=2),
genus = c(14, 24, 2, 8, 0, 10, 1, 28, 6, 9, 0, 24, 5, 8))
ggbarplot(rnaOverlapGenus, "cancer_type", "genus",
fill = "dataset", color = "dataset", palette = "Paired", ylim=c(0,50),
xlab = "Cancer/tissue type (tumor and NAT combined when available)", ylab = "Genus count",
title = "Overlapping fungal genera between TCGA RNA-Seq and Weizmann datasets\n(note: intersection among features found in rep200 database)",
label = TRUE, lab.col = "black", lab.pos = "out") +
theme(plot.title = element_text(hjust = 0.5), legend.title=element_blank()) +
ggsave(file = "Figures/Supplementary_Figures/rnaseq_overlap_rep200_reduced_feature_space_genus.png",
dpi = "retina", width = 9, height = 4, units = "in")
allOverlapGenus <- data.frame(dataset=rep(c("Weizmann only", "Found in Weizmann and TCGA"), 8),
cancer_type=rep(c("Bone","Breast", "Colorectal", "Glioblastoma","Lung","Melanoma","Ovarian","Pancreatic"),each=2),
genus = c(3, 11, 1, 37, 0, 10, 0, 10, 0, 28, 2, 13, 0, 24, 5, 8))
ggbarplot(allOverlapGenus, "cancer_type", "genus",
fill = "dataset", color = "dataset", palette = "Paired", ylim=c(0,50),
xlab = "Cancer/tissue type (tumor and NAT combined when available)", ylab = "Genus count",
title = "Overlapping fungal genera between TCGA WGS and RNA-Seq and Weizmann datasets\n(note: intersection among features found in rep200 database)",
label = TRUE, lab.col = "black", lab.pos = "out") +
theme(plot.title = element_text(hjust = 0.5), legend.title=element_blank()) +
ggsave(file = "Figures/Supplementary_Figures/wgs_and_rnaseq_overlap_rep200_reduced_feature_space_genus.png",
dpi = "retina", width = 9, height = 4, units = "in")
source("Supporting_scripts/S05-SummarySE.R") # Contains a function that calculates std error and 95% confidence intervals
mlPerfAll10k_Allcancer <- read.csv("Interim_data/rep_perfFungi_10k_rep1_tcga_higher_taxa_and_intersected_ALL_13Sep21.csv", stringsAsFactors = FALSE)
abbreviationsTCGA_Allcancer <- read.csv("Supporting_data/tcga_abbreviations.csv", stringsAsFactors = FALSE, row.names = 1)
mlPerfAll10k_Allcancer$abbrev <- abbreviationsTCGA_Allcancer[mlPerfAll10k_Allcancer$diseaseType,"abbrev"]
mlPerfAll10k_Allcancer <- mlPerfAll10k_Allcancer[,!(colnames(mlPerfAll10k_Allcancer) == "X")]
colnames(mlPerfAll10k_Allcancer)[1:2] <- c("AUROC","AUPR")
mlPerfAll10k_Allcancer$datasetName[mlPerfAll10k_Allcancer$datasetName == "rep200FungiOrderVSNM"] <- "Order (Decontam)"
mlPerfAll10k_Allcancer$datasetName[mlPerfAll10k_Allcancer$datasetName == "rep200FungiFamilyVSNM"] <- "Family (Decontam)"
mlPerfAll10k_Allcancer$datasetName[mlPerfAll10k_Allcancer$datasetName == "rep200FungiGenusVSNM"] <- "Genus (Decontam)"
mlPerfAll10k_Allcancer$datasetName[mlPerfAll10k_Allcancer$datasetName == "rep200FungiSpeciesVSNM"] <- "Species (Decontam)"
mlPerfAll10k_Allcancer$datasetName[mlPerfAll10k_Allcancer$datasetName == "rep200FungiGenusVSNM_CT"] <- "Genus (CT)"
mlPerfAll10k_Allcancer$datasetName[mlPerfAll10k_Allcancer$datasetName == "rep200FungiSpeciesVSNM_CT"] <- "Species (CT)"
mlPerfAll10k_Allcancer$datasetName[mlPerfAll10k_Allcancer$datasetName == "snmDataOGUFungi"] <- "OGU (CT)"
mlPerfAll10k_Allcancer$datasetName <- factor(mlPerfAll10k_Allcancer$datasetName,
levels = c("Order (Decontam)",
"Family (Decontam)",
"Genus (Decontam)",
"Species (Decontam)",
"Genus (CT)",
"Species (CT)",
"OGU (CT)"))
table(mlPerfAll10k_Allcancer$datasetName)
#-------------------------Plot primary tumor 1 vs. all others performance-------------------------#
# Order level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor") %>%
filter(grepl("Order",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=datasetName)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
facet_wrap(~variable) + scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor | 1 Vs All | Order") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_order.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
#-------------------------Plot primary tumor 1 vs. all others performance-------------------------#
# Order level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor") %>%
filter(grepl("Order",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor | 1 Vs All | Order") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_order.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Family level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor") %>%
filter(grepl("Family",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor | 1 Vs All | Family") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_family.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Genus level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor") %>%
filter(grepl("Genus",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor | 1 Vs All | Genus") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_genus.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Species level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor") %>%
filter(grepl("Species",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor | 1 Vs All | Species") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_species.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
#-------------------------Plot primary tumor vs. adjacent normal tissue performance-------------------------#
# Order level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor vs Solid Tissue Normal") %>%
filter(grepl("Order",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor vs. Adjacent Normal | Order") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_vs_STN_order.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Family level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor vs Solid Tissue Normal") %>%
filter(grepl("Family",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor vs. Adjacent Normal | Family") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_vs_STN_family.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Genus level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor vs Solid Tissue Normal") %>%
filter(grepl("Genus",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor vs. Adjacent Normal | Genus") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_vs_STN_genus.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Species level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Primary Tumor vs Solid Tissue Normal") %>%
filter(grepl("Species",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Primary Tumor vs. Adjacent Normal | Species") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_PT_vs_STN_species.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
#-------------------------Plot blood derived normal 1 vs. all others performance-------------------------#
# Order level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Blood Derived Normal") %>%
filter(grepl("Order",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Blood Derived Normal | 1 Vs All | Order") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_BDN_order.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Family level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Blood Derived Normal") %>%
filter(grepl("Family",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Blood Derived Normal | 1 Vs All | Family") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_BDN_family.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Genus level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Blood Derived Normal") %>%
filter(grepl("Genus",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Blood Derived Normal | 1 Vs All | Genus") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_BDN_genus.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
# Species level
mlPerfAll10k_Allcancer %>%
filter(sampleType == "Blood Derived Normal") %>%
filter(grepl("Species",datasetName)) %>%
filter(!grepl("CT",datasetName)) %>%
droplevels() %>%
reshape2::melt(id.vars = c("rep","abbrev","diseaseType","sampleType","datasetName","minorityClassSize","majorityClassSize","minorityClassName","majorityClassName")) %>%
summarySE(measurevar = "value", groupvars = c("datasetName","variable","abbrev")) %>%
ggplot(aes(reorder(abbrev, value, FUN=median),value, color=variable)) +
geom_errorbar(aes(ymin=value-ci, ymax=value+ci), width=0, position = position_dodge(0.9)) +
geom_point(position = position_dodge(0.9), size=2.5) + xlab("Cancer type") + ylab("Area Under Curve") + theme_pubr() +
# facet_wrap(~variable) +
scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1)) +
ggtitle("All of TCGA | Blood Derived Normal | 1 Vs All | Species") + theme(plot.title = element_text(hjust = 0.5)) +
rotate_x_text(90) + scale_color_nejm(name = "Features") + geom_hline(yintercept = 1, linetype="dashed") +
ggsave("Figures/Supplementary_Figures/mlPerfAll10k_rep1_Allcancers_BDN_species.jpeg", dpi = "retina",
width = 12, height = 6, units = "in")
